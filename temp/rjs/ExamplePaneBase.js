var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i};define(["require","exports","View","TypeScriptGenerator"],function(t,e,i,o){var r=function(e){function i(){e.apply(this,arguments),this._editorId=this.id+"editor",this._editors={}}return __extends(i,e),i.prototype.onActivate=function(){this._findEditors()},i.prototype._findEditors=function(){var e=this;t(["ace"],function(){if(2==e._state){e._editors={};for(var t=e.getViewModel().panes,i=0;i<t.length;i++){var o=t[i];o.hasEditor&&(e._editors[o.key]={pane:o,editor:null})}e._findEditorElements(e.children),e._initializeEditors()}})},i.prototype._findEditorElements=function(t){for(var e=this,i=0;i<t.length;i++){var o=t[i];if(o.subElements&&o.subElements.editor){var r=o.subElements.editor.getAttribute("data-key");e._editors[r]&&(e._editors[r].editor=o._editor,e._editors[r].element=o.subElements.editor)}e._findEditorElements(o.children)}},i.prototype._initializeEditors=function(){function t(){e._updateViewGeneration(),e._updateResult()}var e=this;for(var i in e._editors){var o=e._editors[i],r=o.editor;o.pane.updatesResults&&r.getSession().on("change",t),r.clearSelection()}t()},i.prototype._updateViewGeneration=function(){var t=this._editors.viewtemplate;if(this._editors.html&&t){var e=new o,i=this._editors.html.editor.getValue();try{i=e.generate(i)}catch(r){i=r.message}i=i||"",t.editor.setValue(i),t.editor.clearSelection()}},i.prototype._updateResult=function(){var t=this.subElements.resultFrame.contentWindow.document;t.open();var e="<!doctype html>";e+="<html>",e+="<head>",e+="<style>",this._editors.less&&(e+=this._editors.less.editor.getValue()),e+="</style>",e+="</head>",e+="<body>",this._editors.html&&(e+=this._editors.html.editor.getValue()),e+="</body>",e+="</html>",t.write(e),t.close()},i}(i);return r});