var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AboutPageModel",["require","exports","ViewModel"],function(e,t,i){var n=function(e){function t(){e.apply(this,arguments),this.strings={title:"OneJS is a tiny web framework.",subTitle:"OneJS enables you to build easily reusable web components in an Model View ViewModel (MVVM) pattern. Views (templates) compile to TypeScript, so that type safety and static code analysis can be enforced. This allows for really nice scenarios, such as having an interface available to implement for your view model, based on the binding requirements of the View."},this.viewsExample={panes:[{key:"html",hasEditor:!0,editorType:"xml",updatesResults:!0,title:"FavoriteThings.html",content:'<js-view js-type="FavoriteThings">\n    <div class="c-FavoriteThings">\n        <b>My Favorite things</b>\n        <ul>\n            <li>Whiskers on kittens</li>\n            <li>Warm woolen mittens</li>\n        </ul>\n    </div>\n</js-view>'},{key:"viewtemplate",hasEditor:!0,updatesResults:!1,editorType:"typescript",title:"Generated TypeScript",content:""},{key:"less",hasEditor:!0,updatesResults:!0,editorType:"less",title:"FavoriteThings.css",content:'.c-FavoriteThings {\n    font-family: "Helvetica";\n}\n\nul {\n    margin: 0;\n    padding: 0 25px;\n    font-size: 80%;\n    list-style-type: none;\n'}],selectedPane:"html"},this.viewModelsExample={panes:[{key:"html",hasEditor:!0,editorType:"xml",updatesResults:!0,title:"View",content:'<js-view js-type="FavoriteThings" js-model="FavoriteThingsModel">\n    <div class="c-FavoriteThings">\n        <b js-bind="text:title"></b>\n        <ul js-repeat="thing in things">\n            <li js-bind="text:thing"></li>\n        </ul>\n    </div>\n</js-view>'},{key:"viewmodel",hasEditor:!0,updatesResults:!0,editorType:"typescript",title:"ViewModel",content:"import ViewModel = require('ViewModel');\n\nclass FavoriteThingsModel extends ViewModel {\n    data = {\n        title: 'MyFavorite things',\n        things: [\n            'Whiskers on kittens',\n            'Warm woolen mittens'\n        ]\n    };\n}\n\nexport = FavoriteThingsModel;\n"},{key:"less",hasEditor:!0,updatesResults:!0,editorType:"less",title:"Styles",content:'.c-FavoriteThings {\n    font-family: "Helvetica";\n}\n\nul {\n    margin: 0;\n    padding: 0 25px;\n    font-size: 80%;\n    list-style-type: none;\n'}],selectedPane:"html",isResultPaneVisible:!1},this.viewInViewExample={panes:[{key:"html",hasEditor:!0,editorType:"xml",updatesResults:!0,title:"App.html",content:'<js-view js-type="App" js-model="AppModel">\n\n    <js-view\n        js-name="tomStuff"\n        js-type="FavoriteThings"\n        js-data="tom" ></js-view>\n\n    <js-view\n        js-name="bobStuff"\n        js-type="FavoriteThings"\n        js-data="bob" ></js-view>\n        \n</js-view>\n'},{key:"viewmodel",hasEditor:!0,updatesResults:!0,editorType:"typescript",title:"AppModel.ts",content:"import ViewModel = require('ViewModel');\n\nclass AppModel extends ViewModel {\n    data = {\n        tom: {\n            title: 'Tom\\'s favs',\n            things: [\n                'Watches',\n                'Football'\n            ]\n        },\n        bob: {\n            title: 'Bob\\'s favs',\n            things: [\n                'Movies'\n            ]\n        }\n   };\n}\n\nexport = AppModel;\n"}],selectedPane:"html",isResultPaneVisible:!1},this.eventingExample={panes:[{key:"html",hasEditor:!0,editorType:"xml",updatesResults:!0,title:"ToggleButton.html",content:'<js-view js-type="ToggleButton" js-model="ToggleButtonModel">\n    <button\n        js-bind="text:title,className.isActive:isActive"\n        js-userAction="click:onClick,click:$toggle(isActive)"></button>\n</js-view>\n'},{key:"viewmodel",hasEditor:!0,updatesResults:!0,editorType:"typescript",title:"ToggleButtonModel.ts",content:"import ViewModel = require('ViewModel');\n\nclass ToggleButtonModel extends ViewModel {\n    data = {\n        isActive: false,\n        onClick: function() { alert('toggling!'); }\n   };\n}\n\nexport = ToggleButtonModel;\n"}],selectedPane:"html",isResultPaneVisible:!1}}return __extends(t,e),t}(i);return n});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AboutPageBase",["require","exports","View"],function(e,t,i){var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(i);return n});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("ExamplePaneModel",["require","exports","ViewModel"],function(e,t,i){var n=function(e){function t(){e.apply(this,arguments),this.panes=[{key:"html",hasEditor:!0,updatesResults:!0,editorType:"html",title:"HTML",content:"<div>Hello world</div>"},{key:"less",hasEditor:!0,updatesResults:!0,editorType:"less",title:"Less",content:'.c-FavoriteThings {\n    font-family: "Helvetica";\n}\n\nul {\n    margin: 0;\n    padding: 0 25px;\n    font-size: 80%;\n    list-style-type: none;\n'}],this.isResultPaneVisible=!0,this.selectedPane="html"}return __extends(t,e),t.prototype.isPaneSelected=function(e){return e.pane.key==this.selectedPane},t}(i);return n}),define("xmldom",["require","exports"],function(e,t){t.DOMParser=window.DOMParser}),define("ViewTemplateDefinition",["require","exports"],function(){var e={"js-view":{description:"",attributes:{"js-name":{description:"Defines the member name for the control.",example:"listView"},"js-type":{description:"Defines the child view type.",example:"ListView"},"js-model":{},"js-css":{},"js-options":{}},children:["default","js-view"]},"js-control":{description:"Indicates that a child view should be placed here.",example:'<js-control js-name="listView" js-type="ListView" />',attributes:{"js-name":{description:"Defines the member name for the control.",example:"listView",isRequired:!0},"js-type":{description:"Defines the child view type.",example:"ListView",isRequired:!0},"js-data":{description:"Provides control-specific options to use for initialization.",example:"{ color: 'black'}"}},children:[]},"js-state":{attribute:{"js-name":{description:"Defines the state to expose from the viewModel for testing purposes.",example:"isVideoPlaying"}},children:[]},"default":{description:"Match for any html element.",example:"<div></div>",attributes:{"js-bind":{description:"Defines bindings to apply to the given element.",example:"href:linkUrl, text:linkText, className.isEnabled:isLinkEnabled, style.display:isVisible"},"js-userAction":{description:"Defines events to apply to the given element.",example:"click:onClick, mousemove:onMouseMove"},"js-id":{description:"Defines an id for the element so that on activation the view can find the element and provide it to the view model on activation."},"js-repeat":{description:"Indicates which collection property to repeat the section for, and how to identify the item/index.",example:"item,itemIndex in items"}},children:["js-section","js-control","js-view","default"]}};return e}),define("CompiledViewTemplate",["require","exports","xmldom","./ViewTemplateDefinition"],function(e,t,i,n){var s=function(){function e(e){this._blockCount=0,this._annotationCount=0,e?this.parse(e):this._reset()}return e.prototype.parse=function(e){this._reset(),this.parseRootElement((new i.DOMParser).parseFromString(e,"application/xhtml+xml").documentElement)},e.prototype.parseRootElement=function(e){this.documentElement=e,this.name=e.getAttribute("js-type"),this.isPassThrough=Boolean(e.getAttribute("js-passThrough"))||!1,this.baseViewType=e.getAttribute("js-baseType")||"View",this.viewModelType=e.getAttribute("js-model")||"",this.options=e.getAttribute("js-options")||"",this.cssInclude=e.getAttribute("js-css")||"";var t=e.getAttribute("js-require");if(this.requireList=t?t.split(/[ ,]+/):[],this.name.indexOf(".")>-1){var i=this.name.split(".");this.name=i[i.length-1]}this._parseElementChildren(e)},e.prototype._parseElement=function(e){this._validateElementIsExpected(e)&&this._validateAttributes(e)&&this._performCustomStage("validate",e)&&(this._performCustomStage("process",e),"js-view"!==e.tagName&&this._parseElementChildren(e))},e.prototype._parseElementChildren=function(e){for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];switch(i.nodeType){case e.ELEMENT_NODE:this._parseElement(i);break;case e.TEXT_NODE:var n=i.textContent.trim();n||(e.removeChild(i),t--)}}},e.prototype._reset=function(){this.name="",this.viewModelType="",this.options="",this.annotations={},this.childViews={},this.properties={},this.requireList=[],this.cssInclude="",this.subTemplates=[],this.events=[],this.errors=[],this.documentElement=null,this._annotationCount=0},e.prototype._addError=function(e,t){var i=t?t.lineNumber:void 0,n=t?t.columnNumber:void 0,s=void 0!==i&&void 0!==n?"(line: "+i+", col: "+n+") ":"";this.errors.push(s+e)},e.prototype._performCustomStage=function(e,t){var i=this._getDefinition(t),n=!0,s="_"+e+this._getHandlerName(i.id)+"Element";if(!this[s]||this[s].call(this,t,i))for(var a in i.attributes){var o="_"+e+this._getHandlerName(a)+"Attribute",r=t.getAttribute(a);if(this[o]&&r&&this[o].call(this,t,i,r)===!1){n=!1;break}}else n=!1;return n},e.prototype._validateElementIsExpected=function(e){var t=this._getDefinition(e),i=!0,n=e.parentNode,s=this._getDefinition(n);return s&&-1===s.children.indexOf(t.id)&&(this._addError('The element "'+e.tagName+'" is not a valid child for the element "'+n.tagName+'".',e),i=!1),i},e.prototype._validateAttributes=function(e){var t=!0,i=this._getDefinition(e);for(var n in i.attributes){var s=i.attributes[n];s.isRequired&&!e.getAttribute(n)&&(t=!1,this._addError('The element "'+e.tagName+'" was missing a required attribute "'+n+'".',e))}return t},e.prototype._validateRepeatAttribute=function(t,i,n){t.removeAttribute("js-repeat");var s=n.split(" in "),a=s[0],o=s[1],r="";a.indexOf(",")&&(s=a.split(/[\s,]+/),a=s[0],r=s[1]);for(var l=new e,d=this.parentTemplate?this.parentTemplate._blockCount++:this._blockCount++,c=(this.parentTemplate?this.parentTemplate.name:this.name)+"Block"+d,p=c+"Item",h=t.cloneNode(!0);t.attributes.length;)t.removeAttribute(t.attributes[0].name);for(;t.childNodes.length;)t.removeChild(t.childNodes[0]);var u=t.cloneNode();t.tagName="js-view";var m=t.cloneNode();for(t.setAttribute("js-name",this._toCamelCase(c)),t.setAttribute("js-type",c),t.setAttribute("js-baseType","Repeater"),t.setAttribute("js-passThrough","true"),t.setAttribute("js-options","{ childViewType: '"+p+"', itemName: '\""+a+"\"'"+(r?", itemIndex: '\""+r+"\"'":"")+" }"),t.setAttribute("js-data","{ items: "+o+" }"),m.setAttribute("js-name",this._toCamelCase(p)),m.setAttribute("js-type",p);h.childNodes.length;){var _=h.childNodes[0];m.appendChild(_)}return u.tagName="js-items",h.setAttribute("js-id","surface"),h.appendChild(u),t.appendChild(h),l.parentTemplate=this.parentTemplate||this,l.parseRootElement(m),this.subTemplates.push(l),!0},e.prototype._processViewElement=function(t){var i=new e,n=t.getAttribute("js-name");i.parseRootElement(t);var s=this.childViews[n]={name:n,type:t.getAttribute("js-type")||"",baseType:i.baseViewType,options:t.getAttribute("js-options")||"",data:t.getAttribute("js-data")||"",shouldImport:0==t.childNodes.length,template:i};return s.shouldImport||this.subTemplates.push(i),!0},e.prototype._processIdAttribute=function(e){var t,i=e.getAttribute("js-id");return i&&(t=this._getAnnotation(e),t.childId=i,e.removeAttribute("js-id")),!0},e.prototype._processBindAttribute=function(e,t,i){var n=this,s=n._getAnnotation(e);return i=i.replace(/;/g,","),i.match(/([a-zA-Z0-9-_$:.]*\([^\)]+\)|[^,^(^)]+)/g).forEach(function(t){var i=t.split(":"),a=i[0].trim(),o=i[1].trim(),r=a.split(".");r.length>1?(a=r.shift(),r=r.join(".")):(r=a,a="attr");var l=0==o.indexOf("is")?"boolean":"string";switch(a){case"attr":if("text"===r)s.text=o;else if("html"===r)s.html=o;else{var d=s.attr=s.attr||{};d[r]=o}break;case"className":var c=s.className=s.className||{};l="boolean",c[r]=o;break;case"css":var p=s.css=s.css||{};p[r.toLowerCase()]=o}n.properties[o]||(n.properties[o]={name:o,type:l}),e.removeAttribute("js-bind")}),!0},e.prototype._processUserActionAttribute=function(e,t,i){var n=this,s=n._getAnnotation(e),a=s.events=s.events||{};return i.match(/([a-zA-Z0-9-_$:.]*\([^\)]+\)|[^,^(^)]+)/g).forEach(function(e){e=e.split(":");var t=e[0].trim(),i=e[1].trim();a[t]=a[t]||[],a[t].push(i)}),e.removeAttribute("js-userAction"),!0},e.prototype._getDefinition=function(e){var t=null,i=n[e.tagName]?e.tagName:"default";return e=e.nodeType===e.DOCUMENT_NODE?null:e,e&&(t=n[i],t.id=i),t},e.prototype._getHandlerName=function(e){return"js-"===e.substr(0,3)&&(e=e.substr(3)),e=e.substr(0,1).toUpperCase()+e.substr(1)},e.prototype._getAnnotation=function(e){if(!e.annotation){var t=String(this._annotationCount++);this.annotations[t]=e.annotation={id:t}}return e.annotation},e.prototype._toCamelCase=function(e){return e=e||"",e=e[0].toLowerCase()+e.substr(1)},e}();return s}),define("BaseGenerator",["require","exports","./CompiledViewTemplate"],function(e,t,i){var n="\r\n",s="    ",a=function(){function e(){this.output=""}return e.prototype._getTemplate=function(e){if(this._reset(),this.template=new i(e),this.template.errors.length){var t=this.template.errors.join("\n");throw t}return this.template},e.prototype._reset=function(){this.output="",this.template=null},e.prototype._addLine=function(e,t){this.output+=this._getIndent(t||0)+(e||"")+n},e.prototype._getIndent=function(e){for(var t="",i=0;e>i;i++)t+=s;return t},e.prototype._toTitleCase=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},e}();return a});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("TypeScriptGenerator",["require","exports","./BaseGenerator"],function(require,exports,BaseGenerator){function _toHtml(e){return String(e||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var TypeScriptGenerator=function(_super){function TypeScriptGenerator(){_super.apply(this,arguments)}return __extends(TypeScriptGenerator,_super),TypeScriptGenerator.prototype.generate=function(e){{var t=this,i=this.template=t._getTemplate(e);"I"+i.name+"Model"}if(i.viewModelType&&t._addLine("import "+i.viewModelType+" = require('"+i.viewModelType+"');"),t._addImports(i),i.cssInclude){var n=i.cssInclude.replace(".","");t._addLine("import DomUtils = require('DomUtils');"),t._addLine("import "+n+" = require('"+i.cssInclude+"');"),t._addLine(),t._addLine("DomUtils.loadStyles("+n+".styles);")}return t._addClass(i),t._addLine(),t._addLine("export = "+i.name+";"),t.output},TypeScriptGenerator.prototype._addClass=function(e){for(var t=0;t<e.subTemplates.length;t++)this._addClass(e.subTemplates[t]);this._addLine(),this._addLine("class "+e.name+" extends "+e.baseViewType+" {"),this._addProperties(e),this._addOnInitialize(e),this._addOnViewModelChanged(e),this._addOnRenderElement(e),this._addAnnotations(e),this._addLine("}")},TypeScriptGenerator.prototype._addImports=function(e){function t(e){var n;for(var s in e.childViews){var a=e.childViews[s];a.shouldImport&&(i[a.type]=a),i[a.baseType]=a}for(n=0;n<e.subTemplates.length;n++)t(e.subTemplates[n]);for(n=0;n<e.requireList.length;n++)i[e.requireList[n]]=null}var i={View:{}};i[e.baseViewType]=e,t(e);for(var n in i){var s=n.replace(".","");this._addLine("import "+s+" = require('"+n+"');"),i[n]||this._addLine(s+";")}},TypeScriptGenerator.prototype._addOnInitialize=function(e){var t,i,n=!1;for(i in e.childViews)if(t=e.childViews[i].template,t.isPassThrough){n=!0;break}if(n){this._addLine(),this._addLine("onInitialize() {",1),this._addLine("super.onInitialize();",2);for(i in e.childViews)t=e.childViews[i].template,t.isPassThrough&&this._addLine("this."+i+".owner = "+(e.parentTemplate?"this.owner":"this")+";",2);this._addLine("}",1)}},TypeScriptGenerator.prototype._addOnViewModelChanged=function(e){var t,i=this,n=!1;for(t in e.childViews)if(e.childViews[t].data){n=!0;break}if(n){i._addLine(),i._addLine("onViewModelChanged() {",1),this._addLine("super.onViewModelChanged();",2);for(var t in e.childViews){var s=e.childViews[t];if(s.data){var a=s.data;if(0==a.indexOf("{")){a=a.substr(1,a.length-2);var o=a.split(","),r=!0;a="{";for(var l=0;l<o.length;l++){var d=o[l].trim().split(/[\s:]+/);a+=(r?"":",")+" "+d[0].trim()+": this.getValue('"+d[1].trim()+"')",r=!1}a+=" }"}else a="this.getValue('"+a+"')";this._addLine("this."+t+".setData("+a+");",2)}}i._addLine("}",1)}},TypeScriptGenerator.prototype._addProperties=function(template){if(this._addLine("viewName = '"+template.name+"';",1),template.options){var optionsBag=eval("("+template.options+")");for(var optionName in optionsBag)this._addLine(optionName+" = "+optionsBag[optionName]+";",1)}template.viewModelType&&this._addLine("viewModelType = "+template.viewModelType+";",1);for(var memberName in template.childViews){var childViewDefinition=template.childViews[memberName];this._addLine(memberName+" = <any>this.addChild(new "+childViewDefinition.type+"());",1)}},TypeScriptGenerator.prototype._addOnRenderElement=function(e){var t=this;t._addLine(),t._addLine("onRenderElement(): HTMLElement {",1),t._addLine("var _this = this;",2),t._addLine("var bindings = _this._bindings;",2),t._addLine(),this._addChildElements(e.documentElement,2),t._addLine("}",1)},TypeScriptGenerator.prototype._addChildElements=function(e,t){for(var i="js-view"===e.tagName,n=i?"return (_this.element = ":"",s=0;s<e.childNodes.length;s++){var a=e.childNodes[s],o=a.annotation,r=o?"bindings["+o.id+"]":null,l=s==e.childNodes.length-1?i?");":"":",";if("js-view"===a.tagName)this._addLine(n+"_this."+a.getAttribute("js-name")+".renderElement()"+l,t);else if(a.nodeType===e.ELEMENT_NODE){for(var d=[],c=0;c<a.attributes.length;c++)d.push(a.attributes[c].name),d.push(a.attributes[c].value);var p=a.childNodes.length>0,h=p?", [":")"+l,u=p;p&&"js-items"==a.childNodes[0].tagName&&(u=!1,h=", this.getChildElements())"+l),this._addLine(n+'_this._ce("'+a.tagName+'", '+JSON.stringify(d)+(r||p?", "+r:"")+h,t),u&&(this._addChildElements(a,t+1),this._addLine("])"+l,t))}else a.nodeType===e.TEXT_NODE&&this._addLine("_this._ct("+JSON.stringify(a.textContent)+")"+l,t)}},TypeScriptGenerator.prototype._addOnRenderHtml=function(e){var t=this;t._addLine(),t._addLine("onRenderHtml(): string {",1),t._addLine("return '' +",2),this._addChildNodes(e.documentElement,3),t._addLine("'';",3),t._addLine("}",1)},TypeScriptGenerator.prototype._addChildNodes=function(e,t){for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(n.nodeType===e.ELEMENT_NODE)this._addRenderLine(n,t);else if(n.nodeType===e.TEXT_NODE){var s=n.textContent.trim();s&&this._addLine("'"+_toHtml(s)+"' +",t)}}},TypeScriptGenerator.prototype._addRenderLine=function(e,t){var i=this;if("js-view"===e.tagName)i._addLine("this."+e.getAttribute("js-name")+".renderHtml() +",t);else{var n=(e.nodeType,e.tagName),s=e.annotation,a=e.childNodes.length>0||s&&(s.html||s.text||s.repeat),o=a?">' +":"></"+n+">' +";i._addLine("'<"+n+this._getIdAttribute(e)+this._getCreationMethod(e,"_genStyle","css","style")+this._getCreationMethod(e,"_genClass","className","class")+this._getCreationMethod(e,"_genAttr","attr")+this._getRemainingAttributes(e)+o,t),a&&(i._addElementContent(e,t+1)&&i._addChildNodes(e,t+1),i._addLine("'</"+n+">' +",t))}},TypeScriptGenerator.prototype._addElementContent=function(e,t){var i=e.annotation,n=!0;return i&&(i.text&&this._addLine("this._genText('"+i.text+"') +",t),i.html&&this._addLine("this._genHtml('"+i.text+"') +",t)),n},TypeScriptGenerator.prototype._addAnnotations=function(e){var t=this,i=[];for(var n in e.annotations)i.push(JSON.stringify(e.annotations[n],null,4));i.length&&(t._addLine(),t._addLine("_bindings = [",1),i.join(",\n").split("\n").forEach(function(e){t._addLine(e,2)}),t._addLine("];",1))},TypeScriptGenerator.prototype._getIdAttribute=function(e){var t="",i=e.annotation;return i&&(t=" id=\"' + this.id + '_"+i.id+'"'),t},TypeScriptGenerator.prototype._getCreationMethod=function(e,t,i,n){var s=e.annotation,a=s?s[i]:null,o="",r=[],l=e.getAttribute(n)||"";if(a){n&&e.removeAttribute(n),l="'"+l+"'";for(var d in a)r.push("'"+d+"'"),r.push("'"+a[d]+"'");o=" ' + this."+t+"("+l,r.length&&(o+=", ["+r.join(",")+"]"),o+=") + '"}return o},TypeScriptGenerator.prototype._getRemainingAttributes=function(e){for(var t=[],i=0;i<e.attributes.length;i++){var n=e.attributes[i];t.push(n.name+'="'+_toHtml(n.value)+'"')}return t.length?" "+t.join(" "):""},TypeScriptGenerator}(BaseGenerator);return TypeScriptGenerator});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("ExamplePaneBase",["require","exports","View","TypeScriptGenerator"],function(e,t,i,n){var s=function(t){function i(){t.apply(this,arguments),this._editorId=this.id+"editor",this._editors={}}return __extends(i,t),i.prototype.onActivate=function(){this._findEditors()},i.prototype._findEditors=function(){var t=this;e(["ace"],function(){if(2==t._state){t._editors={};for(var e=t.getViewModel().panes,i=0;i<e.length;i++){var n=e[i];n.hasEditor&&(t._editors[n.key]={pane:n,editor:null})}t._findEditorElements(t.children),t._initializeEditors()}})},i.prototype._findEditorElements=function(e){for(var t=this,i=0;i<e.length;i++){var n=e[i];if(n.subElements&&n.subElements.editor){var s=n.subElements.editor.getAttribute("data-key");t._editors[s]&&(t._editors[s].editor=n._editor,t._editors[s].element=n.subElements.editor)}t._findEditorElements(n.children)}},i.prototype._initializeEditors=function(){function e(){t._updateViewGeneration(),t._updateResult()}var t=this;for(var i in t._editors){var n=t._editors[i],s=n.editor;n.pane.updatesResults&&s.getSession().on("change",e),s.clearSelection()}e()},i.prototype._updateViewGeneration=function(){var e=this._editors.viewtemplate;if(this._editors.html&&e){var t=new n,i=this._editors.html.editor.getValue();try{i=t.generate(i)}catch(s){i=s.message}i=i||"",e.editor.setValue(i),e.editor.clearSelection()}},i.prototype._updateResult=function(){var e=this.subElements.resultFrame.contentWindow.document;e.open();var t="<!doctype html>";t+="<html>",t+="<head>",t+="<style>",this._editors.less&&(t+=this._editors.less.editor.getValue()),t+="</style>",t+="</head>",t+="<body>",this._editors.html&&(t+=this._editors.html.editor.getValue()),t+="</body>",t+="</html>",e.write(t),e.close()},i}(i);return s});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AceEditorModel",["require","exports","ViewModel"],function(e,t,i){var n=function(e){function t(){e.apply(this,arguments),this.key="html",this.editorType="html",this.content="<div>Hello world</div>"}return __extends(t,e),t}(i);return n});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AceEditorBase",["require","exports","View"],function(e,t,i){var n=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.onActivate=function(){var t=this;e(["ace"],function(){if(2==t._state){var e=t._editor=ace.edit(t.subElements.editor),i=t.getViewModel();t._editor.getSession().setMode("ace/mode/"+i.editorType),e.setValue(i.content)}})},i.prototype.onDeactivate=function(){},i}(i);return n});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AceEditor",["require","exports","AceEditorModel","AceEditorBase"],function(e,t,i,n){var s=function(e){function t(){e.apply(this,arguments),this.viewName="AceEditor",this.viewModelType=i,this._bindings=[{id:"0",attr:{"data-key":"key"},childId:"editor"}]}return __extends(t,e),t.prototype.onRenderElement=function(){var e=this,t=e._bindings;return e.element=e._ce("div",["class","edit"],t[0])},t}(n);return s}),define("ExamplePane.css",["require","exports"],function(e,t){t.styles=".c-ExamplePane{height:240px;background:#e8e8e8;position:relative;color:#666}.c-ExamplePane .tab2col1{position:absolute;left:0;top:0;height:100%;width:100%}.c-ExamplePane.showResults .tab2col1{width:50%;right:auto}.c-ExamplePane .tab2col2{position:absolute;left:50%;top:0;width:50%;height:35px;border-left:1px solid #ddd}.c-ExamplePane.showResults .tab2col2{height:auto;bottom:0}.c-ExamplePane .pane{display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.c-ExamplePane .pane .title{display:inline-block;padding:0 10px;margin-right:5px;height:35px;line-height:35px;font-size:.7em;cursor:pointer}.c-ExamplePane .pane .title:hover{background:#e8e8e8}.c-ExamplePane .pane .edit{display:none;position:absolute;left:0;right:0;top:35px;bottom:0;border-top:1px solid #ddd}.c-ExamplePane .pane .result{position:absolute;border:none;width:100%;height:100%}.c-ExamplePane .pane.isSelected .title{border-top:5px solid #5a9edd;background:linear-gradient(to top,rgba(232,232,232,0) 0,rgba(232,232,232,.4) 78%,rgba(90,158,221,.2) 100%) #f3f3f3;height:30px;line-height:25px;-webkit-tap-highlight-color:transparent;box-shadow:0 0 14px -6px}.c-ExamplePane .pane.isSelected .edit{display:block}@media (max-width:640px){.c-ExamplePane{height:480px}.c-ExamplePane .tab2col1{height:50%}.c-ExamplePane.showResults .tab2col1{width:100%}.c-ExamplePane .tab2col2{left:0;top:240px;width:100%}}"});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("ExamplePane",["require","exports","ExamplePaneModel","View","ExamplePaneBase","Repeater","AceEditor","DomUtils","ExamplePane.css"],function(e,t,i,n,s,a,o,r,l){r.loadStyles(l.styles);var d=function(e){function t(){e.apply(this,arguments),this.viewName="ExamplePaneBlock0Item",this.editor=this.addChild(new o),this._bindings=[{id:"0",className:{isSelected:"$parent.isPaneSelected"}},{id:"1",text:"pane.title",events:{click:["$view.send('pane.key', '$parent.selectedPane')"]}}]}return __extends(t,e),t.prototype.onViewModelChanged=function(){e.prototype.onViewModelChanged.call(this),this.editor.setData(this.getValue("pane"))},t.prototype.onRenderElement=function(){var e=this,t=e._bindings;return e.element=e._ce("div",["class","pane"],t[0],[e._ce("div",["class","title"],t[1]),e.editor.renderElement()])},t}(n),c=function(e){function t(){e.apply(this,arguments),this.viewName="ExamplePaneBlock0",this.childViewType=d,this.itemName="pane",this._bindings=[{id:"0",childId:"surface"}]}return __extends(t,e),t.prototype.onRenderElement=function(){var e=this,t=e._bindings;return e.element=e._ce("div",[],t[0],this.getChildElements())},t}(a),p=function(e){function t(){e.apply(this,arguments),this.viewName="ExamplePane",this.viewModelType=i,this.examplePaneBlock0=this.addChild(new c),this._bindings=[{id:"0",className:{showResults:"isResultPaneVisible"}},{id:"1",className:{isSelected:"isResultPaneVisible"}},{id:"2",events:{click:["$view.toggle('isResultPaneVisible')"]}},{id:"3",childId:"resultFrame"}]}return __extends(t,e),t.prototype.onInitialize=function(){e.prototype.onInitialize.call(this),this.examplePaneBlock0.owner=this},t.prototype.onViewModelChanged=function(){e.prototype.onViewModelChanged.call(this),this.examplePaneBlock0.setData({items:this.getValue("panes")})},t.prototype.onRenderElement=function(){var e=this,t=e._bindings;return e.element=e._ce("div",["class","c-ExamplePane"],t[0],[e._ce("div",["class","tab2col1"],null,[e.examplePaneBlock0.renderElement()]),e._ce("div",["class","tab2col2"],null,[e._ce("div",["class","pane"],t[1],[e._ce("div",["class","title"],t[2],[e._ct("Result")]),e._ce("div",["class","edit"],null,[e._ce("iframe",["class","result"],t[3])])])])])},t}(s);return p}),define("AboutPage.css",["require","exports"],function(e,t){t.styles=".c-AboutPage .editor{height:100px;font-family:Consolas}.c-AboutPage .bigEditor{height:300px}"});var __extends=this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);i.prototype=t.prototype,e.prototype=new i};define("AboutPage",["require","exports","AboutPageModel","AboutPageBase","ExamplePane","DomUtils","AboutPage.css"],function(e,t,i,n,s,a,o){a.loadStyles(o.styles);var r=function(e){function t(){e.apply(this,arguments),this.viewName="AboutPage",this.viewModelType=i,this.viewsExamplePane=this.addChild(new s),this.viewModelsExamplePane=this.addChild(new s),this.viewInViewExamplePane=this.addChild(new s),this.eventingExamplePane=this.addChild(new s)}return __extends(t,e),t.prototype.onViewModelChanged=function(){e.prototype.onViewModelChanged.call(this),this.viewsExamplePane.setData(this.getValue("viewsExample")),this.viewModelsExamplePane.setData(this.getValue("viewModelsExample")),this.viewInViewExamplePane.setData(this.getValue("viewInViewExample")),this.eventingExamplePane.setData(this.getValue("eventingExample"))},t.prototype.onRenderElement=function(){{var e=this;e._bindings}return e.element=e._ce("div",["class","c-AboutPage page"],null,[e._ce("p",["class","warn"],null,[e._ct("Warning: design is being reviewed and instructions subject to change.")]),e._ce("h1",[],null,[e._ct("OneJS is a toolset for building reusable web things.")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct('Don\'t think of it as "yet another JavaScript framework."')]),e._ct("It's a small set of JavaScript classes that provide a common core for producing reusable control libraries while minimizing impact on file size.")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("You only load what you need.")]),e._ct("Everything is modular and is required using "),e._ce("a",["href","http://requirejs.org/"],null,[e._ct("RequireJS.")]),e._ct(" If you only need the View class, you only bundle that with your code. If you use repeat blocks, you include the Repeater class. If you use Selection, you include that. Grow your core only as big as you need it to be. A barebones reusable web component, merged with the common core only adds 3k to the package. No more demanding yet another framework on their site.")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("Start with html and css, make it reusable.")]),e._ct(" Creating an easily instantiatable JavaScript view class is a matter of adding tags around your markup and piping it through a template compiler.")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("Simple to understand.")]),e._ct(" HTML templates compile to easily consumable JavaScript classes, so that they can be reused over and over.")]),e._ce("h2",[],null,[e._ct("OneJS consists of")]),e._ce("ol",[],null,[e._ce("li",[],null,[e._ct("A core set of TypeScript classes, available from the github repo "),e._ce("a",["href","https://github.com/dzearing/onejs","target","_blank"],null,[e._ct("OneJS")]),e._ct(". You include only what you need and merge into a small redistributable, or build a site and merge a collection of controls plus classes together.")]),e._ce("li",[],null,[e._ct("A "),e._ce("a",["href","https://github.com/dzearing/onejs-compiler","target","_blank"],null,[e._ct("template compiler")]),e._ct(" that can validate your html and binding correctness, and output a JavaScript or TypeScript class which can be instantiated and rendered. Available as a "),e._ce("a",["href","https://github.com/dzearing/gulp-onejs-compiler","target","_blank"],null,[e._ct("gulp plugin.")])]),e._ce("li",[],null,[e._ct("A "),e._ce("a",["href","http://github.com/dzearing/gulp-csstojs","target","_blank"],null,[e._ct("css to js converter")]),e._ct(" that converts css into a JavaScript module which can be bundled, loaded on demand, and remapped for localization purposes.")])]),e._ce("h2",[],null,[e._ct("Try it")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("1.")]),e._ct("Install "),e._ce("a",["href","http://nodejs.org/","target","_blank"],null,[e._ct("node.js")]),e._ct(". We use node to build stuff and run tests. We also use "),e._ce("a",["href","http://gulpjs.com","target","_blank"],null,[e._ct("gulp")]),e._ct(" as our build tool of choice.")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("2.")]),e._ct('Get to a command line where you can run "npm" and install the OneJS project generator.')]),e._ce("p",["class","code"],null,[e._ce("div",[],null,[e._ct("npm install -g yo")]),e._ce("div",[],null,[e._ct("npm install -g generator-onejs")])]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("3.")]),e._ct(" Make a new directory, and cd into it.")]),e._ce("p",["class","code"],null,[e._ct("mkdir my-onejs-project && cd $_")]),e._ce("p",[],null,[e._ce("b",[],null,[e._ct("4.")]),e._ct("Run the generator to generate a new OneJS view project. Follow the prompts, etc.")]),e._ce("p",["class","code"],null,[e._ct("yo onejs")]),e._ce("p",[],null,[e._ct("Spin up a server/browser with watch/livereload support, which will auto build your stuff and refresh your page:")]),e._ce("p",["class","code"],null,[e._ct("gulp")]),e._ce("p",[],null,[e._ct("Then open index.html in a browser open with an example page. All of the source is in the /src directory. Try editing the "),e._ce("b",[],null,[e._ct("src/{YourControl}/{YourControl.html")]),e._ct(" file, run gulp and refresh.")]),e._ce("h2",[],null,[e._ct("How it works")]),e._ce("p",[],null,[e._ct("OneJS encourages a separation between view and view models. You can build easy to consume, easy to reuse components that can be shared and reused.")]),e._ce("h2",[],null,[e._ct("Views")]),e._ce("p",[],null,[e._ct("Let's start with a view template. A view template is defined by a "),e._ce("span",["class","ref"],null,[e._ct("js-view")]),e._ct(" element, with a "),e._ce("span",["class","ref"],null,[e._ct("js-type")]),e._ct(" attribute indicating the class name. Within it, you can put whatever markup you want. This is piped through the onejs-compiler (here, running in the browser) which can output the view to a JavaScript (or TypeScript) class which can be intantiated and rendered on demand:")]),e.viewsExamplePane.renderElement(),e._ce("p",[],null,[e._ct("If you inspect the TypeScript tab, you will see a View subclass with a small set of imports and a render function that returns a string. This is generated by the OneJS compiler, which is available as a "),e._ce("a",["href","http://github.com/dzearing/gulp-onejs-compiler"],null,[e._ct("gulp")]),e._ct(" plugin. We can instantiate that class and call its "),e._ce("span",["class","ref"],null,[e._ct("renderHtml")]),e._ct(" method to programatically get the content as a string, which we can innerHTML into the page.")]),e._ce("h2",[],null,[e._ct("View models and binding")]),e._ce("p",[],null,[e._ct("Now we have a class that can render our markup, but it's values are hardcoded. To make this component dynamic, we should set up a view model to hold default states, so that they can be changed independently of the view. To do this, we add the "),e._ce("span",["class","ref"],null,[e._ct("js-model")]),e._ct(" attribute to the view, and add "),e._ce("span",["class","ref"],null,[e._ct("js-bind")]),e._ct(" binding attributes to the various elements to map what property goes where.")]),e.viewModelsExamplePane.renderElement(),e._ce("p",[],null,[e._ct("The "),e._ce("span",["class","ref"],null,[e._ct("js-bind")]),e._ct(" attribute has support for binding text, html, attributes, css values, and toggling classes. The source can be any property or function in the view model's data heirarchy. See the binding documentation for more information, or jump to the following examples:")]),e._ce("ul",[],null,[e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: binding text")])]),e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: binding html")])]),e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: binding attributes")])]),e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: binding class name toggles")])]),e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: repeating")])]),e._ce("li",[],null,[e._ce("a",["href","#/docs"],null,[e._ct("Example: conditionals")])])]),e._ce("p",[],null,[e._ct("This is where a gulp or grunt build workflow keeps things refreshed. We use a generator that can read the xhtml template, and generate a JavaScript or TypeScript class for anyone to consume. The class has a list of OneJS AMD dependencies, which means that we can use the build workflow to easily package up JavaScript dependencies together.")]),e._ce("h2",[],null,[e._ct("Using the view in other views")]),e._ce("p",[],null,[e._ct("Having hardcoded values in a view model is fine for static or default values, but really the consumer of the view should be able instantiate your view easily and pass along state that overrides those defaults.")]),e._ce("p",[],null,[e._ct("In the example below, we define an App view that renders two instances of the FavoriteThings control within using the "),e._ce("span",["class","ref"],null,[e._ct("js-view")]),e._ct(" element. The "),e._ce("span",["class","ref"],null,[e._ct("js-name")]),e._ct(" attribute defines the member name of the child, in case we want to reference it later in a view base. The "),e._ce("span",["class","ref"],null,[e._ct("js-type")]),e._ct(" attribute defines the view type, which the generated class will automatically import and inject in the generated markup. The "),e._ce("span",["class","ref"],null,[e._ct("js-data")]),e._ct(" attribute is used to pass along a value in the parent's view model.")]),e.viewInViewExamplePane.renderElement(),e._ce("h2",[],null,[e._ct("Adding eventing")]),e._ce("p",["class","warn"],null,[e._ct('This is TBD. Element events probably should only be directly hooked up to the view itself, not to the view model. However there can be utilities to auto forward calls to the view model to make the "consumer provides the handler" scenario require no code.')]),e._ce("p",[],null,[e._ct("Eventing in OneJS templates can be handled in a few different ways:")]),e._ce("ul",[],null,[e._ce("li",[],null,[e._ct("Auto bind an event to a handler on the view model using the "),e._ce("span",["class","ref"],null,[e._ct("js-userAction")]),e._ct(" attribute. This is useful when a consumer of the view might want to pass in their event handling implementation to the view.")]),e._ce("li",[],null,[e._ct("Bind an event to a helper to do common things, like "),e._ce("span",["class","ref"],null,[e._ct("$toggle")]),e._ct(", shown below, which can toggle a state.")]),e._ce("li",[],null,[e._ct("Manually bind events within a base view. (TBD. This might be auto.) This is typically done when the event handling should be abstracted from the consumer. The base view can for example gather DOM state and translate that state to the view model.")])]),e.eventingExamplePane.renderElement(),e._ce("h2",[],null,[e._ct("Adding view specific logic")]),e._ce("h2",[],null,[e._ct("Merge your styles in")]),e._ce("h2",[],null,[e._ct("Using resources and avoiding singletons")])])
},t}(n);return r});